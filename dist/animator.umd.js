!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.animator={})}(this,function(t){function e(t){var e=t.getAttribute("data-guid");return e||(e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),t.setAttribute("data-guid",e)),e}var n={easeInQuad:function(t,e,n,r){return n*(t/=r)*t+e},easeOutQuad:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){return n*(t/=r)*t*t+e},easeOutCubic:function(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,r){return n*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,r){return n*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,n,r){return 0==t?e:n*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,n,r){return t==r?e+n:n*(1-Math.pow(2,-10*t/r))+e},easeInOutExpo:function(t,e,n,r){return 0==t?e:t==r?e+n:(t/=r/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,n,r){return(t/=r/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,r){var a=1.70158,i=0,u=n;return 0==t?e:1==(t/=r)?e+n:(i||(i=.3*r),u<Math.abs(n)?(u=n,a=i/4):a=i/(2*Math.PI)*Math.asin(n/u),-u*Math.pow(2,10*(t-=1))*Math.sin((t*r-a)*(2*Math.PI)/i)+e)},easeOutElastic:function(t,e,n,r){var a=1.70158,i=0,u=n;return 0==t?e:1==(t/=r)?e+n:(i||(i=.3*r),u<Math.abs(n)?(u=n,a=i/4):a=i/(2*Math.PI)*Math.asin(n/u),u*Math.pow(2,-10*t)*Math.sin((t*r-a)*(2*Math.PI)/i)+n+e)},easeInOutElastic:function(t,e,n,r){var a=1.70158,i=0,u=n;return 0==t?e:2==(t/=r/2)?e+n:(i||(i=r*(.3*1.5)),u<Math.abs(n)?(u=n,a=i/4):a=i/(2*Math.PI)*Math.asin(n/u),t<1?u*Math.pow(2,10*(t-=1))*Math.sin((t*r-a)*(2*Math.PI)/i)*-.5+e:u*Math.pow(2,-10*(t-=1))*Math.sin((t*r-a)*(2*Math.PI)/i)*.5+n+e)},easeInBack:function(t,e,n,r,a){return null==a&&(a=1.70158),n*(t/=r)*t*((a+1)*t-a)+e},easeOutBack:function(t,e,n,r,a){return null==a&&(a=1.70158),n*((t=t/r-1)*t*((a+1)*t+a)+1)+e},easeInOutBack:function(t,e,n,r,a){return null==a&&(a=1.70158),(t/=r/2)<1?n/2*(t*t*((1+(a*=1.525))*t-a))+e:n/2*((t-=2)*t*((1+(a*=1.525))*t+a)+2)+e},easeInBounce:function(t,e,n,r){return n-jQuery.easing.easeOutBounce(r-t,0,n,r)+e},easeOutBounce:function(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,n,r){return t<r/2?.5*jQuery.easing.easeInBounce(2*t,0,n,r)+e:.5*jQuery.easing.easeOutBounce(2*t-r,0,n,r)+.5*n+e}};function r(t,e,n){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1]}function a(t,e,n){return[t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1]}function i(t){return[Math.cos(t),-Math.sin(t),0,0,Math.sin(t),Math.cos(t),0,0,0,0,1,0,0,0,0,1]}function u(t){for(var e,n,r,a,i,u,o,s,c,f,l,d,h,M,v,p,m,g,y,O,E,x,b,I=t[0],w=1;w<t.length;w+=1)r=void 0,O=void 0,E=void 0,x=void 0,b=void 0,i=(e=I)[1],u=e[2],o=e[3],c=e[5],f=e[6],l=e[7],h=e[9],M=e[10],v=e[11],m=e[13],g=e[14],y=e[15],(r=[])[0]=(O=(n=t[w])[0])*(a=e[0])+(E=n[1])*(s=e[4])+(x=n[2])*(d=e[8])+(b=n[3])*(p=e[12]),r[1]=O*i+E*c+x*h+b*m,r[2]=O*u+E*f+x*M+b*g,r[3]=O*o+E*l+x*v+b*y,r[4]=(O=n[4])*a+(E=n[5])*s+(x=n[6])*d+(b=n[7])*p,r[5]=O*i+E*c+x*h+b*m,r[6]=O*u+E*f+x*M+b*g,r[7]=O*o+E*l+x*v+b*y,r[8]=(O=n[8])*a+(E=n[9])*s+(x=n[10])*d+(b=n[11])*p,r[9]=O*i+E*c+x*h+b*m,r[10]=O*u+E*f+x*M+b*g,r[11]=O*o+E*l+x*v+b*y,r[12]=(O=n[12])*a+(E=n[13])*s+(x=n[14])*d+(b=n[15])*p,r[13]=O*i+E*c+x*h+b*m,r[14]=O*u+E*f+x*M+b*g,r[15]=O*o+E*l+x*v+b*y,I=r;return I}var o,s=function(t,e,n){var r="string"==typeof t?parseInt(t,10):t;return Math.min(Math.max(r,e),n)},c=function(t,e,n,r,a){return n===e?a:(t-e)*(a-r)/(n-e)+r},f="eb",l="et",d="ec",h=[],M=function(){(o={}).st=0,o.sc=window.innerHeight/2,o.sb=window.innerHeight};function v(t,e){return void 0===e&&(e=0),void 0!==t?t:e}M(),window.__animators=h,t.ELEM_BOTTOM=f,t.ELEM_TOP=l,t.ELEM_CENTER=d,t.SCREEN_BOTTOM="sb",t.SCREEN_TOP="st",t.SCREEN_CENTER="sc",t.updateAll=function(){h.forEach(function(t){t.updateElements()})},t.Animator=function(){var t=this,p=[],m=[],g=[],y={},O={},E={},x={};function b(t){var e=t;return"HTML"===t.tagName&&(e=document.scrollingElement||t),e.scrollTop}function I(t,e,n){if("number"==typeof e)return e;var r=e.match(/([-0-9.]+)(.+)/),a=parseFloat(r[1]);switch(r[2]){case"vh":return a/100*window.innerHeight;case"vw":return a/100*window.innerWidth;case"px":return a;case"%":default:return function(t,e,n){switch(t){case"y":return e/100*n.clientHeight;case"x":default:return e/100*n.clientWidth}}(t,a,n)}}function w(t,e,n,r,a,i){void 0===a&&(a=null),void 0===i&&(i=null);var u=p[r];return a?u=a:u&&!Array.isArray(u)&&(u=u.props),u?u.reduce(function(t,r){var a=Object.assign({},r);delete a.when,a=Object.keys(a).map(function(t){return[t,r[t]]});var u=function(t,e,n){var a,i=r.when.split("_");if(2!==i.length)throw new Error('Missing parameters in animation "when" (expects: ELEM_* | SCREEN_*)');switch(i[0]){default:case l:a=e.top;break;case d:a=e.top+e.height/2;break;case f:a=e.top+e.height}return a-o[i[1]]}(0,n);return a.reduce(function(n,r){var a=r[0],o=r[1];return n[a]=t[a]||[],n[a].push([u,I(a,o,i||e)]),n},t)},{}):{}}function A(t,e){var r=s(e.st,e.startOffset,e.endOffset),a=c(r,e.startOffset,e.endOffset,0,1);return t[e.key]=e.ease?n[e.ease](a,e.startValue,e.endValue-e.startValue,1):c(r,e.startOffset,e.endOffset,e.startValue,e.endValue),t}function k(t,e){return t.keys.map(function(n){return Object.assign({},{st:e,ease:t.ease,key:n},t.keyframes[n].reduce(function(t,e,n){var r=e[0],a=e[1];switch(n){case 0:t.startOffset=r,t.startValue=a;break;case 1:default:t.endOffset=r,t.endValue=a}return t},{}))}).reduce(A,{})}function C(t){if(void 0!==t.rotation||void 0!==t.scaleX||void 0!==t.scaleY||void 0!==t.x||void 0!==t.y||void 0!==t.z){var e="translate("+v(t.x,0)+"px, "+v(t.y,0)+"px)",n="rotate("+v(t.rotation,0)+"deg)",r="scale("+v(t.scaleX,1)+", "+v(t.scaleY,1)+")";t.transform=e+" "+n+" "+r}return delete t.rotation,delete t.scaleX,delete t.scaleY,delete t.x,delete t.y,delete t.z,t}function S(t,e){void 0===e&&(e=!1);var n=t.style.transform;t.style.transform="";var o=window.getComputedStyle(t).getPropertyValue("transform");if(t.style.transform=n,"none"===o)return null;var s=o.replace(/matrix(?:3d)?\(/i,"").replace(")","").split(",").map(function(t){return parseFloat(t.trim())});return s.length<16&&e?function(t){return 16===t.length?t:u([[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r(t[4],t[5],0),i(0),a(t[0],t[3],1)])}(s):s}function B(t){return p[t]&&p[t].ease||null}function P(t){return p[t]&&p[t].force3d||!1}function j(t,n){var r=function(t){for(var n=null,r=t;r.parentElement&&!n;)((r=r.parentElement).getAttribute("data-scrollbar")||""===r.getAttribute("data-scrollbar"))&&(n=r);if(!g.find(function(t){return n===t})){var a=e(n);x[a]=r.getBoundingClientRect().top+r.scrollTop,g.push(n)}return n}(n),a=n.getAttribute("data-animator-id"),i=function(t,n){var r=n.getAttribute("style");n.setAttribute("style","");var a=n.getBoundingClientRect(),i=a.top,u=a.height,o=b(t),s=e(t);return n.setAttribute("style",r),{top:i-x[s]+o,height:u}}(r,n);e(n);var u=w(0,n,i,a),o={node:n,context:r,is3DMatrix:P(a),ease:B(a),keyframes:u,keys:Object.keys(u),initialMatrix:S(n,P(a))};return t.push(o),t.concat(function(t,e,n,r){return Array.isArray(p[r])?[]:(p[r]&&p[r].children||[]).reduce(function(a,i){return Array.from(e.querySelectorAll(i.selector)).forEach(function(u){var o=w(0,e,n,null,i.props,u);a.push({node:u,parent:e,context:t,ease:i.ease,is3DMatrix:P(r),keyframes:o,keys:Object.keys(o),initialMatrix:S(u,P(r))})}),a},[])}(r,n,i,a))}h.push(this);var Q=function(t){var n=e(t),o="HTML"===t.tagName?window:t;y[n]?o.removeEventListener("scroll",y[n]):y[n]=function(){!function(t){var n=e(t),o=b(t);O[n]&&cancelAnimationFrame(O[n]),O[n]=requestAnimationFrame(function(){!function(t,n){m.forEach(function(o){if(o.context===t&&0!==Object.keys(o.keyframes).length){var s=null;if(~o.node.namespaceURI.indexOf("svg"))s=C(k(o,n));else if(o.is3DMatrix||o.initialMatrix&&16===o.initialMatrix.length)s=function(t,e){return void 0===e.rotation&&void 0===e.scaleX&&void 0===e.scaleY&&void 0===e.x&&void 0===e.y&&void 0===e.z||(e.transform="matrix3d("+u([t,r(v(e.x),v(e.y),v(e.z)),i(v(e.rotation)),a(v(e.scaleX,1),v(e.scaleY,1),v(e.scaleZ,1))]).join(",")+")"),delete e.rotation,delete e.scaleX,delete e.scaleY,delete e.x,delete e.y,delete e.z,e}(o.initialMatrix,k(o,n));else if((s=C(k(o,n))).transform&&o.initialMatrix){var c=o.initialMatrix,f=c[0],l=c[1],d=c[2],h=c[3],M=c[4],p=c[5],m=Math.sign(f)*Math.sqrt(f*f+l*l),g=Math.sign(h)*Math.sqrt(d*d+h*h),y=Math.atan2(-l,f);s.transform+=" "+C({scaleX:m,scaleY:g,rotation:y,x:M,y:p}).transform}var O=e(o.node);(function(t,e){return!E[t]||E[t]!==JSON.stringify(e)})(O,s)&&(Object.assign(o.node.style,s),E[O]=JSON.stringify(s))}})}(t,o)})}(t)},o.addEventListener("scroll",y[n]),y[n](t)};this.updateElements=function(){M(),g=[];var t=document.querySelectorAll("[data-animator-id]");m=Array.from(t).reduce(j,[]),g.forEach(Q)},this.setAnimations=function(e){p=e,t.updateElements()},this.debug=function(){console.log("animations",p),console.log("elements",m),console.log("contexts",g)}}});
//# sourceMappingURL=animator.umd.js.map
